define("chess-grid",["backbone"],function(){var e=Backbone.View.extend({elms:{item:".chess-grid-item",image:".chess-grid-image"},options:{},initialize:function(){var e=this;e.parseOptions(),e.options.columns||(e.options.columns=2),e.options.margin||(e.options.margin=0),e.renderGrid(),1=="onorientationchange"in window?$(window).on("orientationchange.chess-grid",function(){e.resizeGrid()}).trigger("orientationchange.chess-grid"):$(window).on("resize.chess-grid",function(){e.resizeGrid()}).trigger("resize.chess-grid")},parseOptions:function(){var e=this,t=this.$el.data()||{};return $.each(t,function(n,r){t.hasOwnProperty(n)&&(e.options[n]=r)}),this},renderGrid:function(){var e=this,t=0,n=Math.round((e.$el.width()-(e.options.columns*2-1)*e.options.margin)/e.options.columns/2);e.$el.find(e.elms.item).each(function(){var t=$(this).data("type");switch(t){case"2x1":$(this).width(n*2+e.options.margin).height(n);break;case"2x2":$(this).width(n*2+e.options.margin).height(n*2+e.options.margin);break;case"nx2":$(this).width("100%").height(n*2+e.options.margin)}});var r=0,i=0;e.$el.find(e.elms.item).each(function(){i=$(this).index(),$(this).position().top!=r&&(r=$(this).position().top,e.$el.find(e.elms.item).eq(i-1).addClass("last"))}),e.$el.find(e.elms.item).eq(i).addClass("last"),e.options.margin>0&&e.$el.find(e.elms.item).css({marginBottom:e.options.margin})},resizeGrid:function(){var e=this,t=Math.round((e.$el.width()-(e.options.columns*2-1)*e.options.margin)/e.options.columns/2);console.log(t);var n=t*e.options.columns*2+(e.options.columns*2-1)*e.options.margin,r=n-e.$el.width();e.$el.find(e.elms.item).each(function(){var n=$(this).data("type"),i=$(this).is(".last"),s=$(this).data("rate");s=s==undefined?1*t:s*t;switch(n){case"2x1":$(this).width(t*2+e.options.margin).height(t),i==1&&$(this).width($(this).width()-r);break;case"2x2":$(this).width(t*2+e.options.margin).height(t*2+e.options.margin),i==1&&$(this).width($(this).width()-r);break;case"nx2":$(this).width("100%").height(t*2+e.options.margin)}i==0&&e.options.margin>0&&$(this).css({marginRight:e.options.margin}),$(this).is(".text-left")&&($(this).find(".chess-grid-text").width(s),$(this).find(".chess-grid-image").css("marginLeft",s)),$(this).is(".text-right")&&($(this).find(".chess-grid-text").width(s),$(this).find(".chess-grid-image").css("marginRight",s))})},setImageSize:function(e){var t=parseInt($(e).attr("data-width")),n=parseInt($(e).attr("data-height")),r=t/n;$(e).data("imageRate",r).addClass(r>=1?"w":"h"),$(e).css({marginTop:0,marginLeft:0});var i=$(e).width(),s=$(e).parent().width();if(i!=s){var o=$(e).attr("data-align");switch(o){case"left":o=0;break;case"right":o=s-i;break;default:o=parseInt((s-i)/2)}$(e).css("marginLeft",o+"px")}var u=$(e).height(),a=$(e).parent().height();u!=a&&$(e).css("marginTop",parseInt((a-u)/2)+"px")},render:function(){return this}});return e});